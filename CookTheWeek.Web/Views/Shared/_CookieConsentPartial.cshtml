@using Microsoft.AspNetCore.Http.Features
@using static CookTheWeek.Common.GeneralApplicationConstants
@{
    var consentFeature = Context.Features.Get<ITrackingConsentFeature>();
    var consentCookie = Context.Request.Cookies[CookieConsentName];
    bool cookieExists = !string.IsNullOrEmpty(consentCookie);
    var cookieName = "";

    if (!cookieExists)
    {
        cookieName = consentFeature?.CreateConsentCookie(); // Cookie string for "Accept All"
    }   
}


@if (!cookieExists)
{
    <div id="cookieConsent" class="alert alert-info alert-dismissible fade show" role="alert">
        <div class="d-flex flex-column gap-3 align-items-center justify-content-between">
            <h3><span><i class="fa-solid fa-cookie-bite"></i></span>
                We use cookies
            </h3>
            <p>
                By using this website, you automatically accept that we use cookies. 
            </p>
            <a id="hideCookieBanner" href="/Home/CookiePolicy" class="btn btn-outline-primary w-100 text-center">
                <span aria-hidden="true">What for?</span>
            </a>
            <button id="acceptAll" type="button" class="btn btn-primary w-100 text-center" >
                <span aria-hidden="true">Ok, I understand</span>
            </button>
            
        </div>        
    </div>
    <script>
        (function () {
            
            var acceptAllButton = document.getElementById("acceptAll");
            var readMoreButton = document.getElementById("hideCookieBanner");
            
            acceptAllButton.addEventListener("click", function () {
                
                document.cookie = "@cookieName";
                document.getElementById("cookieConsent").style.display = "none";
                
            });            

            @* readMoreButton.addEventListener("click", function () {                            
                
                document.getElementById("cookieConsent").style.display = "none";
            }); *@

        })();
    </script>
}
